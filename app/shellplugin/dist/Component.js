sap.ui.define(["sap/ui/core/UIComponent"],function(e){"use strict";const t=e.extend("be.nmbs.shellplugin.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init:async function t(){e.prototype.init.call(this);e.prototype.init.call(this);var n=window._paq=window._paq||[];n.push(["setDomains",["*.hana.ondemand.com"]]);n.push(["enableLinkTracking"]);n.push(["setDocumentTitle",document.title]);n.push(["setCustomUrl",document.URL]);n.push(["trackPageView"]);const o=await this.fetchWorkzoneID();const s=sap.ui.require.toUrl("be/nmbs/plugins/shellplugin")+"/Piwik/";n.push(["setTrackerUrl",s+"piwik.php"]);n.push(["setSiteId",o]);var i=document,r=i.createElement("script"),a=i.getElementsByTagName("script")[0];r.type="text/javascript";r.async=true;r.defer=true;r.src=s+"piwik.js";console.log(o);a.parentNode.insertBefore(r,a);var c=location.href;window.addEventListener("hashchange",()=>{n.push(["setReferrerUrl",c]);c=document.URL;n.push(["setCustomUrl",document.URL]);n.push(["setDocumentTitle",this.getHash()]);n.push(["trackPageView"]);n.push(["MediaAnalytics::scanForMedia",document]);n.push(["FormAnalytics::scanForForms",document]);n.push(["trackContentImpressionsWithinNode",document]);n.push(["enableLinkTracking"]);piwik_log(this.getHash(),o,s+"piwik.php")},false)},getHash:function e(){let t=location.hash;if(t.indexOf("?")>-1){t=location.hash.substr(0,location.hash.indexOf("?"))}t=t.indexOf("&")>-1?t.substr(0,t.indexOf("&")):t;return t},fetchWorkzoneID:async function e(){try{const e=this.getModel();const t=e?.bindContext(`/getWorkzoneID(...)`,undefined,{});await(t?.execute());const n=t?.getBoundContext();if(!n){console.warn("No context returned from getWorkzoneID");return""}const o=n.getObject();if(o&&o.value){console.log("Workzone ID:",o.value);return o.value}else{console.warn("No data.value found in context");return""}}catch(e){console.error("Error fetching Workzone ID",e);return""}}});return t});
//# sourceMappingURL=Component.js.map